{
  "title": "ZgwZaakToZdsResponseItem",
  "$id": "https://zds.nl/mapping/zds.ZgwZaakToZdsResponseItem.mapping.json",
  "$schema": "https://docs.commongateway.nl/schemas/Mapping.schema.json",
  "version": "0.0.8",
  "passTrough": false,
  "mapping": {
    "@StUF:entiteittype": "ZAK",
    "@StUF:sleutelVerzendend": "12004",
    "@StUF:sleutelGegevensbeheer": "12004",
    "ZKN:identificatie": "identificatie",
    "ZKN:omschrijving": "omschrijving",
    "ZKN:toelichting": "toelichting",
    "ZKN:resultaat.ZKN:omschrijving": "_expand.resultaat._expand.resultaattype.omschrijving",
    "ZKN:resultaat.ZKN:toelichting": "_expand.resultaat.toelichting",
    "ZKN:startdatum": "startdatum",
    "ZKN:registratiedatum": "registratiedatum",
    "ZKN:publicatiedatum": "publicatiedatum",
    "ZKN:uiterlijkeEinddatum": "uiterlijkeEinddatumAfdoening",
    "ZKN:einddatum": "{{ einddatum|date(Ymd) }}",
    "ZKN:betalingsIndicatie": "betalingsindicatie",
    "ZKN:laatsteBetaaldatum": "laatsteBetaaldatum",
    "ZKN:einddatumGepland": "einddatumGepland",
    "ZKN:zaakniveau": "1",
    "ZKN:deelzakenIndicatie": "N",
    "StUF:extraElementen.StUF:extraElement": "[{% for eigenschap in eigenschappen %}{% if not loop.first %},{% endif %}{{ map('https://zds.nl/mapping/zds.ZgwEigenschapToZds.mapping.json', eigenschap)|json_encode }}{% endfor %}]",
    "ZKN:isVan.@StUF:entiteittype": "ZAKZKT",
    "ZKN:isVan.@StUF:verwerkingssoort": "T",
    "ZKN:isVan.ZKN:gerelateerde.@StUF:entiteittype": "ZKT",
    "ZKN:isVan.ZKN:gerelateerde.@StUF:sleutelOntvangend": "5700000000000000000000000000000000000001",
    "ZKN:isVan.ZKN:gerelateerde.@StUF:verwerkingssoort": "T",
    "ZKN:isVan.ZKN:gerelateerde.ZKN:omschrijving": "_expand.zaaktype.omschrijving",
    "ZKN:isVan.ZKN:gerelateerde.ZKN:code": "_expand.zaaktype.identificatie",
    "ZKN:heeftAlsInitiator": "{% if rollen.0 is defined %}{{ map(\"https://zds.nl/mapping/zds.ZgwZaakToZdsResponseItemInitiator.mapping.json\", rollen.0)|json_encode }}{% else %}\"\"{% endif %}",
    "ZKN:heeft.@StUF:entiteittype": "ZAKSTT",
    "ZKN:heeft.ZKN:gerelateerde.@StUF:entiteittype": "STT",
    "ZKN:heeft.ZKN:gerelateerde.ZKN:volgnummer": "_expand.status._expand.statustype.volgnummer",
    "ZKN:heeft.ZKN:gerelateerde.ZKN:omschrijving": "_expand.status._expand.statustype.omschrijving",
    "ZKN:heeft.ZKN:gerelateerde.ZKN:omschrijvingGeneriek": "_expand.status._expand.statustype.omschrijvingGeneriek",
    "ZKN:heeft.ZKN:toelichting": "_expand.status.statustoelichting",
    "ZKN:heeft.ZKN:datumStatusGezet": "{{ _expand.status.datumStatusGezet|date('Ymdhis') }}",
    "ZKN:heeftRelevant": "{% if _giveDetails == true %}{% set uuids = _expand.zaakinformatieobjecten|column('informatieobject')|map(v => v|split('/')|last) %}{% set json = {'uuid__in': uuids, 'expand': 'informatieobjecttype'} %}{% set _documents = call('https://zds.vng.nl/endpoints/zgw.drc.source.json', '/enkelvoudiginformatieobjecten/_zoek', 'POST', {'json': json }).results %}{% set zaakInformatieobjectenExpanded = _expand.zaakinformatieobjecten|map(zaakinformatieobject => zaakinformatieobject|merge({'_expand': {'informatieobject': _documents|filter(v => v.url == zaakinformatieobject.informatieobject)|first}})) %}{{ map('https://zds.nl/mapping/zds.ZgwZaakInformatieObjectToZdsHeeftRelevant.mapping.json', zaakInformatieobjectenExpanded, true)|json_encode }}{% endif %}"
  },
  "cast": {
    "StUF:extraElementen.StUF:extraElement": "jsonToArray",
    "ZKN:heeftAlsInitiator": ["jsonToArray", "unsetIfValue=="],
    "ZKN:heeftRelevant": ["jsonToArray", "unsetIfValue=="],
    "ZKN:einddatum": "unsetIfValue==",
    "ZKN:resultaat.ZKN:omschrijving": "unsetIfValue==_expand.resultaat._expand.resultaattype.omschrijving",
    "ZKN:resultaat.ZKN:toelichting": "unsetIfValue==_expand.resultaat.toelichting"
  }
}
